<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜çº§JavaScriptè·¯ç”±å™¨æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
        }

        .demo-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .demo-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-section {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            align-items: start;
        }

        .nav-menu {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 20px;
            position: sticky;
            top: 20px;
        }

        .nav-menu h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .nav-menu router-link {
            display: block;
            padding: 12px 16px;
            margin-bottom: 8px;
            text-decoration: none;
            color: #4a5568;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .nav-menu router-link:hover {
            background: #e6fffa;
            color: #38b2ac;
            transform: translateX(5px);
        }

        .nav-menu router-link.router-link-active {
            background: #38b2ac;
            color: white;
            box-shadow: 0 4px 12px rgba(56, 178, 172, 0.3);
        }

        .nav-menu router-link.router-link-exact-active {
            background: #319795;
            border-color: #2c7a7b;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 30px;
            min-height: 400px;
        }

        .content-area h1 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .content-area h2 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .content-area p {
            color: #718096;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .user-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .user-card h3 {
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .user-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
        }

        .controls {
            margin-bottom: 20px;
        }

        .btn {
            background: #38b2ac;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #319795;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(56, 178, 172, 0.3);
        }

        .btn-secondary {
            background: #4a5568;
        }

        .btn-secondary:hover {
            background: #2d3748;
        }

        .status-bar {
            background: rgba(45, 55, 72, 0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .route-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .route-info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
        }

        .route-info-item strong {
            color: #68d391;
        }

        .error-message {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #e53e3e;
        }

        .success-message {
            background: #c6f6d5;
            color: #22543d;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #38a169;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #38b2ac;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .feature-card h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feature-card ul {
            list-style: none;
            padding-left: 0;
        }

        .feature-card li {
            padding: 5px 0;
            color: #4a5568;
        }

        .feature-card li:before {
            content: "âœ“ ";
            color: #38b2ac;
            font-weight: bold;
        }

        #router-progress {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            height: 3px !important;
            background: linear-gradient(90deg, #38b2ac, #4fd1c7) !important;
            z-index: 9999 !important;
            transition: width 0.3s ease, opacity 0.3s ease !important;
            box-shadow: 0 0 10px rgba(56, 178, 172, 0.5) !important;
        }

        @media (max-width: 768px) {
            .nav-section {
                grid-template-columns: 1fr;
            }
            
            .nav-menu {
                position: static;
            }
            
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ é«˜çº§JavaScriptè·¯ç”±å™¨æ¼”ç¤º</h1>
            <p>åŠŸèƒ½å®Œæ•´çš„å•é¡µåº”ç”¨è·¯ç”±è§£å†³æ–¹æ¡ˆ</p>
        </div>

        <div class="demo-section">
            <h2>ğŸ“Š å½“å‰è·¯ç”±çŠ¶æ€</h2>
            <div class="status-bar" id="route-status">
                <div class="route-info">
                    <div class="route-info-item">
                        <strong>å½“å‰è·¯å¾„:</strong> <span id="current-path">-</span>
                    </div>
                    <div class="route-info-item">
                        <strong>è·¯ç”±åç§°:</strong> <span id="current-name">-</span>
                    </div>
                    <div class="route-info-item">
                        <strong>å‚æ•°:</strong> <span id="current-params">-</span>
                    </div>
                    <div class="route-info-item">
                        <strong>æŸ¥è¯¢å‚æ•°:</strong> <span id="current-query">-</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ§­ è·¯ç”±å¯¼èˆªæ¼”ç¤º</h2>
            <div class="nav-section">
                <div class="nav-menu">
                    <h3>å¯¼èˆªèœå•</h3>
                    <router-link to="/">ğŸ  é¦–é¡µ</router-link>
                    <router-link to="/about">ğŸ“– å…³äºæˆ‘ä»¬</router-link>
                    <router-link to="/user/123">ğŸ‘¤ ç”¨æˆ·123</router-link>
                    <router-link to="/user/456">ğŸ‘¤ ç”¨æˆ·456</router-link>
                    <router-link to="/products">ğŸ›ï¸ äº§å“åˆ—è¡¨</router-link>
                    <router-link to="/products/laptop">ğŸ’» ç¬”è®°æœ¬ç”µè„‘</router-link>
                    <router-link to="/products/phone">ğŸ“± æ™ºèƒ½æ‰‹æœº</router-link>
                    <router-link to="/admin">ğŸ”’ ç®¡ç†åå°</router-link>
                    <router-link to="/search?q=javascript&sort=date">ğŸ” æœç´¢é¡µé¢</router-link>
                    <router-link to="/contact#form">ğŸ“§ è”ç³»æˆ‘ä»¬</router-link>
                    <router-link to="/nonexistent">âŒ 404é¡µé¢</router-link>
                </div>

                <div class="content-area">
                    <router-view></router-view>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ® ç¼–ç¨‹å¼å¯¼èˆª</h2>
            <div class="controls">
                <button class="btn" onclick="navigateTo('/')">é¦–é¡µ</button>
                <button class="btn" onclick="navigateTo('/about')">å…³äº</button>
                <button class="btn" onclick="navigateToUser()">éšæœºç”¨æˆ·</button>
                <button class="btn btn-secondary" onclick="router.back()">åé€€</button>
                <button class="btn btn-secondary" onclick="router.forward()">å‰è¿›</button>
                <button class="btn btn-secondary" onclick="router.go(-2)">åé€€2æ­¥</button>
                <button class="btn btn-secondary" onclick="showRouteInfo()">è·¯ç”±ä¿¡æ¯</button>
            </div>
        </div>

        <div class="demo-section">
            <h2>âš¡ è·¯ç”±å™¨ç‰¹æ€§</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§</h4>
                    <ul>
                        <li>å†…å­˜æ³„æ¼é˜²æŠ¤</li>
                        <li>æ ˆæº¢å‡ºä¿æŠ¤</li>
                        <li>å¾ªç¯å¼•ç”¨æ£€æµ‹</li>
                        <li>è¾“å…¥å‚æ•°éªŒè¯</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸš€ æ€§èƒ½ä¼˜åŒ–</h4>
                    <ul>
                        <li>LRUç¼“å­˜ç®—æ³•</li>
                        <li>ç»„ä»¶æ‡’åŠ è½½</li>
                        <li>è¿›åº¦æ¡æ˜¾ç¤º</li>
                        <li>å¹¶å‘æ§åˆ¶</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</h4>
                    <ul>
                        <li>Hash/Historyæ¨¡å¼</li>
                        <li>åµŒå¥—è·¯ç”±æ”¯æŒ</li>
                        <li>å¯¼èˆªå®ˆå«ç³»ç»Ÿ</li>
                        <li>åŠ¨æ€è·¯ç”±ç®¡ç†</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ”§ å¼€å‘ä½“éªŒ</h4>
                    <ul>
                        <li>è‡ªå®šä¹‰HTMLå…ƒç´ </li>
                        <li>è¯¦ç»†é”™è¯¯æç¤º</li>
                        <li>TypeScriptå‹å¥½</li>
                        <li>è°ƒè¯•æ—¥å¿—æ”¯æŒ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { createRouter, RouterMode, NavigationFailureType, isNavigationFailure } from './js/router.js';

        // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
        const userData = {
            123: { name: 'å¼ ä¸‰', email: 'zhang@example.com', role: 'å¼€å‘è€…', joinDate: '2023-01-15' },
            456: { name: 'æå››', email: 'li@example.com', role: 'è®¾è®¡å¸ˆ', joinDate: '2023-03-20' },
            789: { name: 'ç‹äº”', email: 'wang@example.com', role: 'äº§å“ç»ç†', joinDate: '2023-02-10' }
        };

        // æ¨¡æ‹Ÿäº§å“æ•°æ®
        const productData = {
            laptop: { name: 'é«˜ç«¯æ¸¸æˆç¬”è®°æœ¬', price: 'Â¥12,999', brand: 'TechMaster', specs: ['Intel i7', '32GB RAM', 'RTX 4070'] },
            phone: { name: 'æ™ºèƒ½æ‰‹æœºPro', price: 'Â¥6,999', brand: 'PhoneTech', specs: ['éªé¾™8 Gen2', '12GB RAM', '50MPæ‘„åƒå¤´'] }
        };

        // å®šä¹‰è·¯ç”±é…ç½®
        const routes = [
            {
                path: '/',
                name: 'home',
                component: () => `
                    <div>
                        <h1>ğŸ  æ¬¢è¿æ¥åˆ°é¦–é¡µ</h1>
                        <p>è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„JavaScriptè·¯ç”±å™¨æ¼”ç¤ºé¡µé¢ï¼Œå±•ç¤ºäº†ç°ä»£Webåº”ç”¨ä¸­çš„è·¯ç”±ç®¡ç†åŠŸèƒ½ã€‚</p>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <h4>ğŸŒŸ ä¸»è¦ç‰¹è‰²</h4>
                                <p>æ”¯æŒHashå’ŒHistoryæ¨¡å¼ï¼Œå…·å¤‡å®Œæ•´çš„å¯¼èˆªå®ˆå«ç³»ç»Ÿï¼Œå†…ç½®æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨é˜²æŠ¤æœºåˆ¶ã€‚</p>
                            </div>
                            <div class="feature-card">
                                <h4>ğŸ¯ ä½¿ç”¨åœºæ™¯</h4>
                                <p>é€‚ç”¨äºå•é¡µåº”ç”¨(SPA)ã€æ¸è¿›å¼Webåº”ç”¨(PWA)ä»¥åŠéœ€è¦å®¢æˆ·ç«¯è·¯ç”±çš„ç°ä»£Webé¡¹ç›®ã€‚</p>
                            </div>
                        </div>
                    </div>
                `,
                meta: { title: 'é¦–é¡µ', description: 'è·¯ç”±å™¨æ¼”ç¤ºé¦–é¡µ' }
            },
            {
                path: '/about',
                name: 'about',
                component: () => `
                    <div>
                        <h1>ğŸ“– å…³äºæˆ‘ä»¬</h1>
                        <h2>é¡¹ç›®ä»‹ç»</h2>
                        <p>è¿™ä¸ªé«˜çº§JavaScriptè·¯ç”±å™¨æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜ç§€çš„å®¢æˆ·ç«¯è·¯ç”±è§£å†³æ–¹æ¡ˆã€‚å®ƒæä¾›äº†ç°ä»£Webåº”ç”¨æ‰€éœ€çš„æ‰€æœ‰è·¯ç”±åŠŸèƒ½ï¼ŒåŒæ—¶ç¡®ä¿äº†é«˜å¯é æ€§å’Œå®‰å…¨æ€§ã€‚</p>
                        
                        <h2>æŠ€æœ¯ç‰¹ç‚¹</h2>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <h4>ğŸ›¡ï¸ å®‰å…¨å¯é </h4>
                                <ul>
                                    <li>å†…å­˜æ³„æ¼é˜²æŠ¤</li>
                                    <li>æ ˆæº¢å‡ºä¿æŠ¤</li>
                                    <li>è¾“å…¥éªŒè¯æœºåˆ¶</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>âš¡ é«˜æ€§èƒ½</h4>
                                <ul>
                                    <li>LRUç¼“å­˜ç­–ç•¥</li>
                                    <li>å¼‚æ­¥ç»„ä»¶åŠ è½½</li>
                                    <li>æ™ºèƒ½é¢„åŠ è½½</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `,
                meta: { title: 'å…³äºæˆ‘ä»¬', description: 'äº†è§£è·¯ç”±å™¨é¡¹ç›®' }
            },
            {
                path: '/user/:id',
                name: 'user',
                component: (params) => {
                    const user = userData[params.id];
                    if (!user) {
                        return `
                            <div class="error-message">
                                <h2>âŒ ç”¨æˆ·ä¸å­˜åœ¨</h2>
                                <p>ç”¨æˆ·ID "${params.id}" ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·IDæ˜¯å¦æ­£ç¡®ã€‚</p>
                            </div>
                        `;
                    }
                    return `
                        <div>
                            <h1>ğŸ‘¤ ç”¨æˆ·è¯¦æƒ…é¡µ</h1>
                            <div class="user-card">
                                <h3>ç”¨æˆ·ä¿¡æ¯</h3>
                                <div class="user-info">
                                    <div class="info-item">
                                        <strong>ID:</strong> ${params.id}
                                    </div>
                                    <div class="info-item">
                                        <strong>å§“å:</strong> ${user.name}
                                    </div>
                                    <div class="info-item">
                                        <strong>é‚®ç®±:</strong> ${user.email}
                                    </div>
                                    <div class="info-item">
                                        <strong>è§’è‰²:</strong> ${user.role}
                                    </div>
                                    <div class="info-item">
                                        <strong>åŠ å…¥æ—¥æœŸ:</strong> ${user.joinDate}
                                    </div>
                                </div>
                            </div>
                            <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†åŠ¨æ€è·¯ç”±å‚æ•°çš„ä½¿ç”¨ã€‚URLä¸­çš„ <code>:id</code> å‚æ•°è¢«è§£æå¹¶ä¼ é€’ç»™ç»„ä»¶ã€‚</p>
                        </div>
                    `;
                },
                meta: { title: 'ç”¨æˆ·è¯¦æƒ…', requiresAuth: false }
            },
            {
                path: '/products',
                name: 'products',
                component: () => `
                    <div>
                        <h1>ğŸ›ï¸ äº§å“åˆ—è¡¨</h1>
                        <p>è¿™é‡Œå±•ç¤ºäº†åµŒå¥—è·¯ç”±çš„æ¦‚å¿µã€‚ä½ å¯ä»¥æµè§ˆå…·ä½“çš„äº§å“é¡µé¢ã€‚</p>
                        <div class="controls">
                            <a href="#/products/laptop" class="btn">ğŸ’» æŸ¥çœ‹ç¬”è®°æœ¬</a>
                            <a href="#/products/phone" class="btn">ğŸ“± æŸ¥çœ‹æ‰‹æœº</a>
                        </div>
                        <router-view name="product"></router-view>
                    </div>
                `,
                children: [
                    {
                        path: ':productId',
                        component: (params) => {
                            const product = productData[params.productId];
                            if (!product) {
                                return `<div class="error-message">äº§å“ "${params.productId}" ä¸å­˜åœ¨</div>`;
                            }
                            return `
                                <div class="user-card" style="margin-top: 20px;">
                                    <h3>${product.name}</h3>
                                    <div class="user-info">
                                        <div class="info-item"><strong>ä»·æ ¼:</strong> ${product.price}</div>
                                        <div class="info-item"><strong>å“ç‰Œ:</strong> ${product.brand}</div>
                                        <div class="info-item"><strong>è§„æ ¼:</strong> ${product.specs.join(', ')}</div>
                                    </div>
                                </div>
                            `;
                        }
                    }
                ]
            },
            {
                path: '/admin',
                name: 'admin',
                component: () => `
                    <div>
                        <h1>ğŸ”’ ç®¡ç†åå°</h1>
                        <div class="success-message">
                            <p>âœ… æƒé™éªŒè¯é€šè¿‡ï¼æ‚¨å·²æˆåŠŸè¿›å…¥ç®¡ç†åå°ã€‚</p>
                        </div>
                        <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†è·¯ç”±å®ˆå«åŠŸèƒ½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ£€æŸ¥ç”¨æˆ·çš„ç™»å½•çŠ¶æ€å’Œæƒé™ã€‚</p>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <h4>ç”¨æˆ·ç®¡ç†</h4>
                                <p>ç®¡ç†ç³»ç»Ÿç”¨æˆ·ï¼Œåˆ†é…è§’è‰²å’Œæƒé™</p>
                            </div>
                            <div class="feature-card">
                                <h4>æ•°æ®ç»Ÿè®¡</h4>
                                <p>æŸ¥çœ‹ç³»ç»Ÿä½¿ç”¨æƒ…å†µå’Œå…³é”®æŒ‡æ ‡</p>
                            </div>
                        </div>
                    </div>
                `,
                beforeEnter: (to, from, next) => {
                    // æ¨¡æ‹Ÿæƒé™æ£€æŸ¥
                    console.log('ğŸ” æ£€æŸ¥ç®¡ç†å‘˜æƒé™...');
                    setTimeout(() => {
                        const hasPermission = Math.random() > 0.3; // 70%æ¦‚ç‡é€šè¿‡
                        if (hasPermission) {
                            console.log('âœ… æƒé™éªŒè¯é€šè¿‡');
                            next();
                        } else {
                            console.log('âŒ æƒé™ä¸è¶³ï¼Œé‡å®šå‘åˆ°é¦–é¡µ');
                            alert('âš ï¸ æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®ç®¡ç†åå°');
                            next('/');
                        }
                    }, 1000);
                },
                meta: { title: 'ç®¡ç†åå°', requiresAuth: true, requiredRole: 'admin' }
            },
            {
                path: '/search',
                name: 'search',
                component: (params, query) => `
                    <div>
                        <h1>ğŸ” æœç´¢é¡µé¢</h1>
                        <div class="user-card">
                            <h3>æœç´¢å‚æ•°</h3>
                            <div class="user-info">
                                <div class="info-item">
                                    <strong>å…³é”®è¯:</strong> ${query.q || 'æ— '}
                                </div>
                                <div class="info-item">
                                    <strong>æ’åºæ–¹å¼:</strong> ${query.sort || 'é»˜è®¤'}
                                </div>
                                <div class="info-item">
                                    <strong>é¡µç :</strong> ${query.page || '1'}
                                </div>
                            </div>
                        </div>
                        <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†æŸ¥è¯¢å‚æ•°çš„è§£æå’Œä½¿ç”¨ã€‚URLä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¼šè¢«è‡ªåŠ¨è§£æä¸ºå¯¹è±¡ã€‚</p>
                    </div>
                `,
                meta: { title: 'æœç´¢' }
            },
            {
                path: '/contact',
                name: 'contact',
                component: () => `
                    <div>
                        <h1>ğŸ“§ è”ç³»æˆ‘ä»¬</h1>
                        <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†Hashç‰‡æ®µçš„å¤„ç†ã€‚</p>
                        <div style="height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                            <h3>å…¬å¸ä¿¡æ¯</h3>
                            <p>æˆ‘ä»¬æ˜¯ä¸€å®¶ä¸“æ³¨äºå‰ç«¯æŠ€æœ¯çš„åˆ›æ–°å…¬å¸...</p>
                            <p>å›¢é˜Ÿæˆå‘˜åŒ…æ‹¬èµ„æ·±å·¥ç¨‹å¸ˆã€è®¾è®¡å¸ˆå’Œäº§å“ç»ç†...</p>
                            <h3>è”ç³»æ–¹å¼</h3>
                            <p>Email: contact@example.com</p>
                            <p>ç”µè¯: +86 138-0013-8000</p>
                            <h3 id="form">è”ç³»è¡¨å•</h3>
                            <div class="user-card">
                                <h4>å‘é€æ¶ˆæ¯</h4>
                                <p>è¿™é‡Œæ˜¯è”ç³»è¡¨å•åŒºåŸŸã€‚Hashç‰‡æ®µ #form ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ°è¿™é‡Œã€‚</p>
                            </div>
                        </div>
                    </div>
                `,
                meta: { title: 'è”ç³»æˆ‘ä»¬' }
            },
            {
                path: '*',
                name: '404',
                component: () => `
                    <div>
                        <div class="error-message">
                            <h1>ğŸš« 404 - é¡µé¢ä¸å­˜åœ¨</h1>
                            <p>æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºï¼š</p>
                            <ul style="margin: 15px 0; padding-left: 20px;">
                                <li>URLè¾“å…¥é”™è¯¯</li>
                                <li>é¡µé¢å·²è¢«åˆ é™¤æˆ–ç§»åŠ¨</li>
                                <li>é“¾æ¥å·²è¿‡æœŸ</li>
                            </ul>
                        </div>
                        <div class="controls">
                            <button class="btn" onclick="router.push('/')">è¿”å›é¦–é¡µ</button>
                            <button class="btn btn-secondary" onclick="router.back()">è¿”å›ä¸Šé¡µ</button>
                        </div>
                    </div>
                `,
                meta: { title: 'é¡µé¢æœªæ‰¾åˆ°' }
            }
        ];

        // åˆ›å»ºè·¯ç”±å™¨å®ä¾‹
        const router = createRouter({
            mode: RouterMode.HISTORY, // ä½¿ç”¨HISTORYæ¨¡å¼,
            routes: routes,
            cacheSize: 30,
            scrollBehavior(to, from, savedPosition) {
                if (savedPosition) {
                    return savedPosition;
                } else if (to.hash) {
                    setTimeout(() => {
                        const element = document.querySelector(to.hash);
                        if (element) {
                            element.scrollIntoView({ behavior: 'smooth' });
                        }
                    }, 300);
                    return { x: 0, y: 0 };
                } else {
                    return { x: 0, y: 0 };
                }
            }
        });

        // è®¾ç½®å…¨å±€å¯¼èˆªå®ˆå«
        router.beforeEach((to, from, next) => {
            console.log(`ğŸš€ å¯¼èˆª: ${from.path} â†’ ${to.path}`);
            
            // æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿ
            if (to.path === '/admin') {
                // ç®¡ç†é¡µé¢æœ‰è‡ªå·±çš„beforeEnterå®ˆå«
                next();
            } else {
                // å…¶ä»–é¡µé¢æ·»åŠ å°å»¶è¿Ÿæ¨¡æ‹ŸåŠ è½½
                setTimeout(() => next(), Math.random() * 500 + 200);
            }
        });

        router.beforeResolve((to, from, next) => {
            console.log(`ğŸ”„ è§£æè·¯ç”±: ${to.path}`);
            next();
        });

        router.afterEach((to, from) => {
            console.log(`âœ… å¯¼èˆªå®Œæˆ: ${to.path}`);
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            if (to.meta && to.meta.title) {
                document.title = `${to.meta.title} - è·¯ç”±å™¨æ¼”ç¤º`;
            }
            
            // æ›´æ–°è·¯ç”±çŠ¶æ€æ˜¾ç¤º
            updateRouteStatus(to);
        });

        // é”™è¯¯å¤„ç†
        router.onError(error => {
            console.error('ğŸš¨ è·¯ç”±é”™è¯¯:', error);
            
            if (isNavigationFailure(error, NavigationFailureType.ABORTED)) {
                console.log('âš ï¸ å¯¼èˆªè¢«ä¸­æ­¢');
            } else if (isNavigationFailure(error, NavigationFailureType.CANCELLED)) {
                console.log('âš ï¸ å¯¼èˆªè¢«å–æ¶ˆ');
            } else if (isNavigationFailure(error, NavigationFailureType.DUPLICATED)) {
                console.log('âš ï¸ é‡å¤å¯¼èˆª');
            }
        });

        // è·¯ç”±å°±ç»ªå¤„ç†
        router.onReady(() => {
            console.log('ğŸ‰ è·¯ç”±å™¨å·²å°±ç»ª');
            updateRouteStatus(router.current);
        }, error => {
            console.error('âŒ è·¯ç”±å™¨åˆå§‹åŒ–å¤±è´¥:', error);
        });

        // åˆå§‹åŒ–è·¯ç”±å™¨
        router.init();

        // å°†è·¯ç”±å™¨å®ä¾‹æš´éœ²åˆ°å…¨å±€ï¼Œä¾›æŒ‰é’®äº‹ä»¶ä½¿ç”¨
        window.router = router;

        // æ›´æ–°è·¯ç”±çŠ¶æ€æ˜¾ç¤ºçš„å‡½æ•°
        function updateRouteStatus(route) {
            document.getElementById('current-path').textContent = route.path || '-';
            document.getElementById('current-name').textContent = route.name || '-';
            document.getElementById('current-params').textContent = 
                Object.keys(route.params || {}).length > 0 ? JSON.stringify(route.params) : '-';
            document.getElementById('current-query').textContent = 
                Object.keys(route.query || {}).length > 0 ? JSON.stringify(route.query) : '-';
        }

        // ç¼–ç¨‹å¼å¯¼èˆªå‡½æ•°
        window.navigateTo = function(path) {
            router.push(path).then(route => {
                console.log('âœ… å¯¼èˆªæˆåŠŸ:', route.path);
            }).catch(error => {
                if (!isNavigationFailure(error, NavigationFailureType.DUPLICATED)) {
                    console.error('âŒ å¯¼èˆªå¤±è´¥:', error);
                }
            });
        };

        window.navigateToUser = function() {
            const userIds = ['123', '456', '789'];
            const randomId = userIds[Math.floor(Math.random() * userIds.length)];
            navigateTo(`/user/${randomId}`);
        };

        window.showRouteInfo = function() {
            const current = router.current;
            const info = {
                path: current.path,
                name: current.name,
                params: current.params,
                query: current.query,
                fullPath: current.fullPath,
                matched: current.matched.map(m => ({
                    path: m.path,
                    name: m.name
                }))
            };
            
            alert('å½“å‰è·¯ç”±ä¿¡æ¯ï¼š\n' + JSON.stringify(info, null, 2));
        };

        // æ·»åŠ ä¸€äº›æ¼”ç¤ºç”¨çš„åŠ¨æ€è·¯ç”±
        setTimeout(() => {
            console.log('ğŸ“ æ·»åŠ åŠ¨æ€è·¯ç”±...');
            
            router.addRoute({
                path: '/dynamic/:timestamp',
                name: 'dynamic',
                component: (params) => `
                    <div>
                        <h1>ğŸ†• åŠ¨æ€æ·»åŠ çš„è·¯ç”±</h1>
                        <div class="success-message">
                            <p>âœ… è¿™ä¸ªè·¯ç”±æ˜¯åœ¨é¡µé¢åŠ è½½ååŠ¨æ€æ·»åŠ çš„ï¼</p>
                        </div>
                        <div class="user-card">
                            <h3>è·¯ç”±ä¿¡æ¯</h3>
                            <div class="user-info">
                                <div class="info-item">
                                    <strong>æ—¶é—´æˆ³:</strong> ${params.timestamp}
                                </div>
                                <div class="info-item">
                                    <strong>åˆ›å»ºæ—¶é—´:</strong> ${new Date(parseInt(params.timestamp)).toLocaleString()}
                                </div>
                            </div>
                        </div>
                        <p>åŠ¨æ€è·¯ç”±ç®¡ç†æ˜¯é«˜çº§è·¯ç”±å™¨çš„é‡è¦ç‰¹æ€§ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤è·¯ç”±ã€‚</p>
                    </div>
                `,
                meta: { title: 'åŠ¨æ€è·¯ç”±', dynamicallyAdded: true }
            });

            // åœ¨å¯¼èˆªèœå•ä¸­æ·»åŠ é“¾æ¥
            const navMenu = document.querySelector('.nav-menu');
            const dynamicLink = document.createElement('router-link');
            dynamicLink.setAttribute('to', `/dynamic/${Date.now()}`);
            dynamicLink.textContent = 'ğŸ†• åŠ¨æ€è·¯ç”±';
            dynamicLink.style.color = '#e53e3e';
            navMenu.appendChild(dynamicLink);
            
            console.log('âœ… åŠ¨æ€è·¯ç”±æ·»åŠ æˆåŠŸ');
        }, 3000);

        // æ¼”ç¤ºè·¯ç”±ç¼“å­˜
        let cacheTestCount = 0;
        router.beforeEach((to, from, next) => {
            if (to.path.startsWith('/user/')) {
                cacheTestCount++;
                console.log(`ğŸ“Š ç”¨æˆ·è·¯ç”±è®¿é—®æ¬¡æ•°: ${cacheTestCount}`);
            }
            next();
        });

        // é”®ç›˜å¯¼èˆªæ”¯æŒ
        document.addEventListener('keydown', (e) => {
            if (e.altKey) {
                switch(e.key) {
                    case '1':
                        e.preventDefault();
                        navigateTo('/');
                        break;
                    case '2':
                        e.preventDefault();
                        navigateTo('/about');
                        break;
                    case '3':
                        e.preventDefault();
                        navigateToUser();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        router.back();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        router.forward();
                        break;
                }
            }
        });

        // æ˜¾ç¤ºé”®ç›˜å¿«æ·é”®æç¤º
        console.log(`
ğŸ® é”®ç›˜å¿«æ·é”®:
Alt + 1: é¦–é¡µ
Alt + 2: å…³äºé¡µé¢  
Alt + 3: éšæœºç”¨æˆ·
Alt + â†: åé€€
Alt + â†’: å‰è¿›
        `);

        // è·¯ç”±æ€§èƒ½ç›‘æ§
        let navigationStartTime;
        router.beforeEach((to, from, next) => {
            navigationStartTime = performance.now();
            next();
        });

        router.afterEach((to, from) => {
            if (navigationStartTime) {
                const duration = performance.now() - navigationStartTime;
                console.log(`â±ï¸ å¯¼èˆªåˆ° ${to.path} è€—æ—¶: ${duration.toFixed(2)}ms`);
            }
        });

        // é¡µé¢å¯è§æ€§å˜åŒ–æ—¶çš„å¤„ç†
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                console.log('ğŸ“´ é¡µé¢éšè—ï¼Œæš‚åœè·¯ç”±æ´»åŠ¨');
            } else {
                console.log('ğŸ‘€ é¡µé¢å¯è§ï¼Œæ¢å¤è·¯ç”±æ´»åŠ¨');
                updateRouteStatus(router.current);
            }
        });

        // åœ¨é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æº
        window.addEventListener('beforeunload', () => {
            console.log('ğŸ§¹ æ¸…ç†è·¯ç”±å™¨èµ„æº...');
            router.destroy();
        });

        // æ¨¡æ‹Ÿç½‘ç»œçŠ¶æ€å˜åŒ–
        if ('onLine' in navigator) {
            window.addEventListener('online', () => {
                console.log('ğŸŒ ç½‘ç»œè¿æ¥æ¢å¤');
            });

            window.addEventListener('offline', () => {
                console.log('ğŸ“¡ ç½‘ç»œè¿æ¥æ–­å¼€');
            });
        }

        // æ·»åŠ è·¯ç”±å˜åŒ–åŠ¨ç”»æ•ˆæœ
        const style = document.createElement('style');
        style.textContent = `
            .content-area {
                transition: opacity 0.3s ease, transform 0.3s ease;
            }
            
            .content-area.route-transition {
                opacity: 0.7;
                transform: translateY(10px);
            }
        `;
        document.head.appendChild(style);

        router.beforeEach((to, from, next) => {
            const contentArea = document.querySelector('.content-area');
            if (contentArea) {
                contentArea.classList.add('route-transition');
            }
            next();
        });

        router.afterEach(() => {
            setTimeout(() => {
                const contentArea = document.querySelector('.content-area');
                if (contentArea) {
                    contentArea.classList.remove('route-transition');
                }
            }, 100);
        });

        // è·¯ç”±ç»Ÿè®¡ä¿¡æ¯
        const routeStats = {
            totalNavigations: 0,
            routeVisits: {},
            errorCount: 0
        };

        router.afterEach((to) => {
            routeStats.totalNavigations++;
            routeStats.routeVisits[to.path] = (routeStats.routeVisits[to.path] || 0) + 1;
            
            if (routeStats.totalNavigations % 5 === 0) {
                console.log('ğŸ“ˆ è·¯ç”±ç»Ÿè®¡:', {
                    æ€»å¯¼èˆªæ¬¡æ•°: routeStats.totalNavigations,
                    æœ€å—æ¬¢è¿è·¯ç”±: Object.keys(routeStats.routeVisits).reduce((a, b) => 
                        routeStats.routeVisits[a] > routeStats.routeVisits[b] ? a : b
                    ),
                    é”™è¯¯æ¬¡æ•°: routeStats.errorCount
                });
            }
        });

        router.onError(() => {
            routeStats.errorCount++;
        });

        console.log('ğŸ¯ è·¯ç”±å™¨æ¼”ç¤ºé¡µé¢åŠ è½½å®Œæˆï¼');
        console.log('ğŸ’¡ æç¤ºï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†çš„è·¯ç”±æ—¥å¿—');
    </script>
</body>
</html>